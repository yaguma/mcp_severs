# Phase 5: ターミナル・ビルド機能実装（約1ヶ月）

**要件名**: MCPエディタ統合サーバー
**期間**: 2026年3月 - 2026年4月（25営業日、200時間）
**目標**: ターミナルコマンド実行とビルドツール統合の完全実装

---

## タスク一覧

### Week 1: ターミナルコマンド実行の実装（5日間、40時間）

#### Day 101: execute_command ツールの実装（基本）
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 の execute_command ツールを実装
  - `src/managers/TerminalExecutor.ts` に `executeCommand()` メソッドを追加
  - child_process.spawn を使用したコマンド実行
  - stdout/stderr のキャプチャと蓄積
  - 終了コード (exitCode) の取得
  - 基本的なエラーハンドリング（コマンド不在、実行権限エラーなど）
- **テスト要件**:
  - コマンドが正常に実行できることのテスト
  - stdout が正しくキャプチャされることのテスト
  - stderr が正しくキャプチャされることのテスト
  - 終了コードが正確であることのテスト
  - コマンド不在時のエラーテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Phase 4 完了
- **受け入れ基準**:
  - [ ] コマンドが正常に実行できること
  - [ ] stdout が正しくキャプチャされること
  - [ ] stderr が正しくキャプチャされること
  - [ ] 終了コードが正確であること
  - [ ] 単体テストが作成されていること

---

#### Day 102: コマンドサニタイゼーションの統合
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 のコマンドサニタイゼーション機能を実装
  - `executeCommand()` メソッドを拡張してセキュリティチェックを追加
  - CommandSanitizer との連携（Phase 1で実装済み）
  - 危険なコマンドパターンのチェック（rm -rf /, mkfs, dd など）
  - ブロック時のエラー返却と詳細なエラーメッセージ
  - 監査ログへの記録（ブロック理由、タイムスタンプ）
- **テスト要件**:
  - 危険なコマンド（rm -rf /）がブロックされることのテスト
  - ブロックされたコマンドがログに記録されることのテスト
  - 安全なコマンド（ls, echo）は実行されることのテスト
  - 複数の危険パターンのテスト
  - 統合テストカバレッジ90%以上
- **依存関係**: Day 101
- **受け入れ基準**:
  - [ ] 危険なコマンドがブロックされること
  - [ ] ブロックされたコマンドがログに記録されること
  - [ ] 安全なコマンドは実行されること
  - [ ] 統合テストが作成されていること

---

#### Day 103: タイムアウト処理の実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 の timeout オプションを実装
  - `executeCommand()` メソッドを拡張してタイムアウト機能を追加
  - timeout パラメータの処理（ミリ秒単位）
  - setTimeout/clearTimeout によるタイムアウト監視
  - タイムアウト時のプロセス強制終了（process.kill）
  - タイムアウトエラーの返却（exitCode: null, timeout: true）
- **テスト要件**:
  - 指定時間でタイムアウトすることのテスト
  - タイムアウト時にプロセスが確実に終了することのテスト
  - タイムアウトエラーが正しく返ることのテスト
  - タイムアウト前に完了するコマンドのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 102
- **受け入れ基準**:
  - [ ] 指定時間でタイムアウトすること
  - [ ] タイムアウト時にプロセスが終了すること
  - [ ] タイムアウトエラーが返ること
  - [ ] 単体テストが作成されていること

---

#### Day 104: バックグラウンド実行機能の実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 の background オプションを実装
  - `executeCommand()` メソッドを拡張してバックグラウンド実行をサポート
  - background フラグの処理（true: 非同期、false: 同期）
  - プロセスIDの管理と返却
  - 非同期実行（Promise での即座の返却）
  - 進捗状況の取得機能（ProcessManager との連携）
- **テスト要件**:
  - バックグラウンドで実行できることのテスト
  - プロセスIDが正しく返ることのテスト
  - 進捗状況が取得できることのテスト
  - 同期実行と非同期実行の切り替えテスト
  - 統合テストカバレッジ90%以上
- **依存関係**: Day 103
- **受け入れ基準**:
  - [ ] バックグラウンドで実行できること
  - [ ] プロセスIDが返ること
  - [ ] 進捗状況が取得できること
  - [ ] 統合テストが作成されていること

---

#### Day 105: execute_command ツール定義の完成
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 の execute_command ツール定義を完成
  - `src/server/tools/ExecuteCommandTool.ts` を作成
  - MCP ツール定義の登録（name, description, inputSchema）
  - JSON Schema の完成（command, timeout, background, cwd, env パラメータ）
  - RequestHandler との統合（executeCommand メソッドの呼び出し）
  - レスポンスフォーマットの実装（stdout, stderr, exitCode, processId）
- **テスト要件**:
  - execute_command ツールが listTools() に含まれることのテスト
  - MCPクライアントから呼び出せることのテスト
  - 各パラメータの検証テスト
  - E2Eテストの作成とカバレッジ90%以上
- **依存関係**: Day 104
- **受け入れ基準**:
  - [ ] execute_command ツールが listTools() に含まれること
  - [ ] MCPクライアントから呼び出せること
  - [ ] E2Eテストが作成されていること

---

### Week 2: ビルドツール検出と実行（5日間、40時間）

#### Day 106: ビルドツール検出の改善
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 1で実装した BuildToolDetector を拡張
  - `src/managers/BuildToolDetector.ts` の拡張
  - より正確な検出ロジック（設定ファイルの存在確認）
  - 複数ビルドツールへの対応（優先順位付き）
  - ビルドスクリプトの解析（package.json, pom.xml, build.gradle など）
  - バージョン情報の取得
- **テスト要件**:
  - npm/yarn/pnpm を正確に検出できることのテスト
  - Maven/Gradle を検出できることのテスト
  - MSBuild/.NET を検出できることのテスト
  - 複数ビルドツールが存在する場合の優先順位テスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 105
- **受け入れ基準**:
  - [ ] npm/yarn/pnpm を正確に検出できること
  - [ ] Maven/Gradle を検出できること
  - [ ] MSBuild/.NET を検出できること
  - [ ] 単体テストが作成されていること

---

#### Day 107: npm/yarn/pnpm ビルドの実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の Node.js ビルド機能を実装
  - `src/managers/TerminalExecutor.ts` に `executeBuild()` メソッドを追加
  - package.json の読み取りと build スクリプトの確認
  - npm run build / yarn build / pnpm build の実行
  - ビルドログのキャプチャと解析
  - エラー・警告メッセージの抽出
- **テスト要件**:
  - npm build が実行できることのテスト
  - yarn build が実行できることのテスト
  - pnpm build が実行できることのテスト
  - ビルドエラーが正しく解析されることのテスト
  - build スクリプトが存在しない場合のエラーテスト
  - 統合テストカバレッジ90%以上
- **依存関係**: Day 106
- **受け入れ基準**:
  - [ ] npm build が実行できること
  - [ ] yarn build が実行できること
  - [ ] pnpm build が実行できること
  - [ ] ビルドエラーが正しく解析されること
  - [ ] 統合テストが作成されていること

---

#### Day 108: Maven/Gradle ビルドの実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の Java ビルド機能を実装
  - `executeBuild()` メソッドを拡張して Maven/Gradle をサポート
  - Maven ビルドの実行（mvn compile, mvn package）
  - Gradle ビルドの実行（gradle build, gradle assemble）
  - ビルドログの解析とエラー抽出
  - エラー・警告メッセージの構造化
- **テスト要件**:
  - mvn compile が実行できることのテスト
  - gradle build が実行できることのテスト
  - ビルドエラーが正しく解析されることのテスト
  - 設定ファイルが存在しない場合のエラーテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 107
- **受け入れ基準**:
  - [ ] mvn compile が実行できること
  - [ ] gradle build が実行できること
  - [ ] ビルドエラーが正しく解析されること
  - [ ] 単体テストが作成されていること

---

#### Day 109: MSBuild/.NET ビルドの実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の .NET ビルド機能を実装
  - `executeBuild()` メソッドを拡張して MSBuild/.NET をサポート
  - MSBuild の実行（msbuild /t:Build）
  - dotnet build の実行
  - ビルドログの解析とエラー抽出
  - C# コンパイラエラーの構造化
- **テスト要件**:
  - msbuild が実行できることのテスト
  - dotnet build が実行できることのテスト
  - ビルドエラーが正しく解析されることのテスト
  - プロジェクトファイルが存在しない場合のエラーテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 108
- **受け入れ基準**:
  - [ ] msbuild が実行できること
  - [ ] dotnet build が実行できること
  - [ ] ビルドエラーが正しく解析されること
  - [ ] 単体テストが作成されていること

---

#### Day 110: execute_build ツール定義の完成
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の execute_build ツール定義を完成
  - `src/server/tools/ExecuteBuildTool.ts` を作成
  - MCP ツール定義の登録（name, description, inputSchema）
  - JSON Schema の完成（buildTool, target, options パラメータ）
  - RequestHandler との統合（executeBuild メソッドの呼び出し）
  - レスポンスフォーマットの実装（success, errors, warnings, buildLog）
- **テスト要件**:
  - execute_build ツールが listTools() に含まれることのテスト
  - MCPクライアントから呼び出せることのテスト
  - 各パラメータの検証テスト
  - E2Eテストの作成とカバレッジ90%以上
- **依存関係**: Day 109
- **受け入れ基準**:
  - [ ] execute_build ツールが listTools() に含まれること
  - [ ] MCPクライアントから呼び出せること
  - [ ] E2Eテストが作成されていること

---

### Week 3: ビルドログ解析とエラー処理（5日間、40時間）

#### Day 111: ビルドログパーサーの実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 のビルドログ解析機能を実装
  - `src/utils/BuildLogParser.ts` を作成
  - ログ行の正規表現による解析
  - エラー・警告の抽出（パターンマッチング）
  - ファイル名・行番号の特定
  - 重要度の判定（error, warning, info）
  - 構造化データへの変換
- **テスト要件**:
  - ビルドエラーが正しく抽出されることのテスト
  - 警告が正しく抽出されることのテスト
  - ファイル・行番号が特定されることのテスト
  - 異なるフォーマットのログのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 110
- **受け入れ基準**:
  - [ ] ビルドエラーが正しく抽出されること
  - [ ] 警告が正しく抽出されること
  - [ ] ファイル・行番号が特定されること
  - [ ] 単体テストが作成されていること

---

#### Day 112: TypeScript/ESLint エラー解析
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の TypeScript/ESLint エラー解析を実装
  - BuildLogParser を拡張して TypeScript/ESLint をサポート
  - TypeScript エラーフォーマットの解析（TS[number]）
  - ESLint エラーフォーマットの解析（rule-name）
  - エラーコードの抽出と分類
  - ファイルパスと行番号の正確な抽出
- **テスト要件**:
  - TypeScript エラーが正しく解析されることのテスト
  - ESLint エラーが正しく解析されることのテスト
  - エラーコード（TS2322, no-unused-vars など）が含まれることのテスト
  - 複数エラーが混在するログのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 111
- **受け入れ基準**:
  - [ ] TypeScript エラーが正しく解析されること
  - [ ] ESLint エラーが正しく解析されること
  - [ ] エラーコードが含まれること
  - [ ] 単体テストが作成されていること

---

#### Day 113: Maven/Gradle エラー解析
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の Maven/Gradle エラー解析を実装
  - BuildLogParser を拡張して Maven/Gradle をサポート
  - Maven エラーフォーマットの解析（[ERROR]）
  - Gradle エラーフォーマットの解析（FAILURE:）
  - スタックトレースの処理と整形
  - コンパイルエラーとビルドエラーの区別
- **テスト要件**:
  - Maven エラーが正しく解析されることのテスト
  - Gradle エラーが正しく解析されることのテスト
  - スタックトレースが正しく含まれることのテスト
  - 依存関係エラーの解析テスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 112
- **受け入れ基準**:
  - [ ] Maven エラーが正しく解析されること
  - [ ] Gradle エラーが正しく解析されること
  - [ ] スタックトレースが含まれること
  - [ ] 単体テストが作成されていること

---

#### Day 114: MSBuild/.NET エラー解析
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.2 の MSBuild/.NET エラー解析を実装
  - BuildLogParser を拡張して MSBuild/.NET をサポート
  - MSBuild エラーフォーマットの解析（error CS[number]:）
  - C# コンパイラエラーの解析
  - エラーコード（CS0029, CS1002 など）の抽出
  - プロジェクトファイルとソースファイルの区別
- **テスト要件**:
  - MSBuild エラーが正しく解析されることのテスト
  - C# コンパイラエラーが正しく解析されることのテスト
  - エラーコードが正しく含まれることのテスト
  - 警告とエラーの区別テスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 113
- **受け入れ基準**:
  - [ ] MSBuild エラーが正しく解析されること
  - [ ] C# エラーが正しく解析されること
  - [ ] エラーコードが含まれること
  - [ ] 単体テストが作成されていること

---

#### Day 115: ビルドログの包括的テスト
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.2](../design/technical-design.md#62-execute_build)
- **推定工数**: 8時間
- **実装詳細**:
  - すべてのビルドツールのログ解析をテスト
  - `tests/integration/build-log-parser.test.ts` を作成
  - 各ビルドツール（npm, Maven, Gradle, MSBuild）のテスト
  - エラー・警告の検出テスト
  - エッジケーステスト（空ログ、不正フォーマットなど）
  - カバレッジレポートの生成
- **テスト要件**:
  - すべてのテストケースがパスすること
  - テストカバレッジが90%以上であること
  - エッジケースが網羅されていること
  - 実際のビルドログサンプルを使用したテスト
- **依存関係**: Day 114
- **受け入れ基準**:
  - [ ] すべてのテストがパスすること
  - [ ] テストカバレッジが90%以上であること

---

### Week 4: プロセス管理と高度な機能（5日間、40時間）

#### Day 116: プロセス管理機能の実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 のプロセス管理機能を実装
  - `src/managers/ProcessManager.ts` を作成
  - プロセスの登録・管理（Map データ構造）
  - プロセス一覧の取得（ID, command, status）
  - プロセスの終了（process.kill）
  - プロセス状態の監視（running, completed, failed）
- **テスト要件**:
  - プロセスが正しく登録されることのテスト
  - プロセス一覧が正しく取得できることのテスト
  - プロセスを正しく終了できることのテスト
  - プロセス状態が正確に監視されることのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 115
- **受け入れ基準**:
  - [ ] プロセスが登録されること
  - [ ] プロセス一覧が取得できること
  - [ ] プロセスを終了できること
  - [ ] 単体テストが作成されていること

---

#### Day 117: プロセス出力のストリーミング
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 のストリーミング出力機能を実装
  - ProcessManager を拡張してストリーミングをサポート
  - ストリーミング出力の取得（chunk ベース）
  - 出力バッファリング（最大サイズ制限）
  - 部分出力の返却（最新 N 行など）
  - オーバーフロー時の古いデータの破棄
- **テスト要件**:
  - リアルタイムで出力が取得できることのテスト
  - バッファオーバーフローが正しく防げることのテスト
  - 部分出力が正しく返却されることのテスト
  - 大量出力時のパフォーマンステスト
  - 統合テストカバレッジ90%以上
- **依存関係**: Day 116
- **受け入れ基準**:
  - [ ] リアルタイムで出力が取得できること
  - [ ] バッファオーバーフローが防げること
  - [ ] 統合テストが作成されていること

---

#### Day 118: 環境変数とワークディレクトリの管理
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 の環境設定機能を実装
  - TerminalExecutor を拡張して環境変数とワークディレクトリをサポート
  - 環境変数の設定（env パラメータ）
  - cwd パラメータの処理（作業ディレクトリの変更）
  - PATH の解決と検証
  - デフォルト環境変数の継承
- **テスト要件**:
  - 環境変数が正しく設定されることのテスト
  - 作業ディレクトリが正しく変更できることのテスト
  - PATH 解決が正しく動作することのテスト
  - 無効なディレクトリパスのエラーテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 117
- **受け入れ基準**:
  - [ ] 環境変数が正しく設定されること
  - [ ] 作業ディレクトリが変更できること
  - [ ] 単体テストが作成されていること

---

#### Day 119: シェルスクリプトの実行
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §6.1 のシェルスクリプト実行機能を実装
  - TerminalExecutor を拡張してスクリプト実行をサポート
  - スクリプトファイルの検出（.sh, .bash, .ps1 など）
  - 適切なシェルの選択（bash, sh, zsh, powershell など）
  - スクリプト実行権限の確認
  - シバン（#!）の解析とインタープリタの決定
- **テスト要件**:
  - bash スクリプトが実行できることのテスト
  - sh スクリプトが実行できることのテスト
  - PowerShell スクリプトが実行できることのテスト（Windows環境）
  - 実行権限がない場合のエラーテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 118
- **受け入れ基準**:
  - [ ] bash スクリプトが実行できること
  - [ ] PowerShell スクリプトが実行できること（Windows）
  - [ ] 単体テストが作成されていること

---

#### Day 120: Phase 5 総合テストとベンチマーク
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §9.2](../design/technical-design.md#92-パフォーマンス要件)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 5の完了確認と総合テストを実施
  - `tests/performance/terminal-build-perf.test.ts` を作成
  - すべてのターミナル・ビルド機能の統合テスト
  - パフォーマンスベンチマークの実行と結果レポート
  - テストカバレッジの測定と確認
  - Phase 5完了レポートの作成
- **テスト要件**:
  - すべてのターミナル・ビルド機能が正常に動作することのテスト
  - コマンド実行のオーバーヘッドが最小限であることの確認
  - テストカバレッジが90%以上であることの確認
  - エンドツーエンドテストの実行
  - ベンチマーク結果のドキュメント化
- **依存関係**: Day 119
- **受け入れ基準**:
  - [ ] すべてのターミナル・ビルド機能が動作すること
  - [ ] コマンド実行のオーバーヘッドが最小限であること
  - [ ] テストカバレッジが90%以上であること

---

### Week 5: ドキュメント整備とリファクタリング（5日間、40時間）

#### Day 121: ターミナル・ビルドAPIドキュメントの作成
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1-6.2](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - ターミナルとビルドのAPIドキュメントを作成
  - `docs/api/terminal-build.md` を作成
  - execute_command API仕様の文書化（パラメータ、レスポンス、エラーコード）
  - execute_build API仕様の文書化
  - サポートされるビルドツール一覧（npm, Maven, Gradle, MSBuild）
  - エラーコード一覧と対処方法
  - 各APIのサンプルコード（TypeScript）の作成
- **依存関係**: Day 120
- **受け入れ基準**:
  - [ ] すべてのAPIが文書化されていること
  - [ ] サンプルコードが動作すること

---

#### Day 122: ユーザーガイドの作成
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1-6.2](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - ターミナルとビルドのユーザーガイドを作成
  - `docs/user-guide/terminal-build.md` を作成
  - コマンド実行の使い方（基本から応用まで）
  - ビルドの実行方法（各ビルドツール別）
  - エラーメッセージの読み方と解釈
  - トラブルシューティングとFAQ
  - 実用的な使用例とユースケース
- **依存関係**: Day 121
- **受け入れ基準**:
  - [ ] 初心者でも理解できる内容であること
  - [ ] 実用的な例が含まれていること

---

#### Day 123: エラーハンドリングの改善
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1-6.2](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - ターミナル・ビルドのエラーハンドリングを見直し
  - より詳細なエラーメッセージの実装
  - エラーコンテキストの追加（コマンド、引数、環境など）
  - リトライ戦略の実装（ネットワークエラー、一時的な失敗など）
  - エラーリカバリー機能の実装
  - エラーログの改善
- **テスト要件**:
  - エラーメッセージが明確で有用であることのテスト
  - リトライが適切に動作することのテスト
  - エラーリカバリーが正しく機能することのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 122
- **受け入れ基準**:
  - [ ] エラーメッセージが明確であること
  - [ ] リトライが適切に動作すること

---

#### Day 124: コードレビューとリファクタリング
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1-6.2](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 5のコード全体をレビューしリファクタリング
  - コードレビューレポートの作成
  - リファクタリング実施（重複コードの削除、命名の改善など）
  - コード品質の向上（ESLint, Prettier の適用）
  - パフォーマンスの最適化
  - 技術的負債の解消
- **依存関係**: Day 123
- **受け入れ基準**:
  - [ ] Lintエラーがないこと
  - [ ] コードの可読性が向上していること

---

#### Day 125: Phase 5 最終レビューと完了確認
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §6.1-6.2](../design/technical-design.md#61-execute_command)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 5の完全性を確認し、次フェーズへの準備を行う
  - Phase 5最終レポートの作成
  - すべての機能の動作確認
  - テストカバレッジの最終確認
  - ドキュメントの整備と最終チェック
  - Phase 6への引き継ぎ事項の整理
  - 課題と改善点の洗い出し
- **依存関係**: Day 124
- **受け入れ基準**:
  - [ ] すべての機能が完成していること
  - [ ] すべてのテストがパスすること
  - [ ] ドキュメントが整備されていること

---

## Phase 5 完了基準

- [ ] execute_command ツールが完全に実装されている
- [ ] execute_build ツールが完全に実装されている
- [ ] すべての主要ビルドツールがサポートされている
- [ ] ビルドログ解析が動作している
- [ ] タイムアウト機能が動作している
- [ ] バックグラウンド実行が動作している
- [ ] プロセス管理が実装されている
- [ ] 環境変数・ワークディレクトリ設定が動作している
- [ ] 単体テストカバレッジが90%以上
- [ ] 統合テストがすべてパスする
- [ ] APIドキュメントとユーザーガイドが完成している

---

## Phase 5 成果物サマリー

| カテゴリ | 成果物 | 推定工数 | 完了 |
|---------|--------|---------|------|
| ターミナル | execute_command, プロセス管理 | 56時間 | ☐ |
| ビルド | execute_build, ビルドツール検出 | 40時間 | ☐ |
| ログ解析 | BuildLogParser (npm/Maven/Gradle/MSBuild対応) | 40時間 | ☐ |
| プロセス管理 | プロセス一覧、終了、ストリーミング出力 | 24時間 | ☐ |
| 環境設定 | 環境変数、ワークディレクトリ | 8時間 | ☐ |
| テスト | 単体テスト、統合テスト、パフォーマンステスト | 16時間 | ☐ |
| ドキュメント | APIドキュメント、ユーザーガイド | 16時間 | ☐ |
| **合計** | **25タスク** | **200時間** | **0/25** |

---

**前のフェーズ**: [Phase 4: コード編集機能実装](./phase-4-code-editing.md)
**次のフェーズ**: [Phase 6: 診断・修正機能実装](./phase-6-diagnostics.md)
