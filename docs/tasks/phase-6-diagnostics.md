# Phase 6: 診断・修正機能実装（約1ヶ月）

**要件名**: MCPエディタ統合サーバー
**期間**: 2026年4月 - 2026年5月（25営業日、200時間）
**目標**: エラー検出、診断情報取得、クイックフィックス機能の完全実装

---

## タスク一覧

### Week 1: 診断情報取得機能の実装（5日間、40時間）

#### Day 126: get_diagnostics ツールの実装（基本）
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1](../design/technical-design.md#71-診断機能)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.1 の DiagnosticsProvider クラスを実装
  - `src/managers/DiagnosticsProvider.ts` に `getDiagnostics()` メソッドを追加
  - エディタアダプターの診断APIとの連携
  - 診断情報（エラー、警告、情報）の取得と整形
  - 重要度（severity）の分類処理
  - ファイルパス、行番号、列番号の取得
  - メッセージと診断コードの取得
- **テスト要件**:
  - ファイルの診断情報が正しく取得できることのテスト
  - エラー・警告・情報が正しく区別されることのテスト
  - ファイルパスと行番号が含まれることのテスト
  - 診断情報がない場合のテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Phase 5 完了
- **受け入れ基準**:
  - [ ] ファイルの診断情報が取得できること
  - [ ] エラー・警告・情報が区別されること
  - [ ] ファイルパスと行番号が含まれること
  - [ ] 単体テストが作成されていること

---

#### Day 127: プロジェクト全体の診断情報取得
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1](../design/technical-design.md#71-診断機能)
- **推定工数**: 8時間
- **実装詳細**:
  - DiagnosticsProvider クラスに `getAllDiagnostics()` メソッドを実装
  - プロジェクト内の全ファイルの走査処理
  - 各ファイルの診断情報の取得と集約
  - ファイルパスをキーとしたグループ化
  - 非同期処理による効率的な取得処理
  - メモリ効率を考慮したストリーミング処理
- **テスト要件**:
  - プロジェクト全体の診断情報が取得できることのテスト
  - ファイルごとに正しくグループ化されることのテスト
  - 大量ファイルでのパフォーマンステスト（1000ファイル以内で5秒以内）
  - 統合テストの作成
- **依存関係**: Day 126
- **受け入れ基準**:
  - [ ] プロジェクト全体の診断情報が取得できること
  - [ ] ファイルごとにグループ化されること
  - [ ] パフォーマンスが許容範囲内であること
  - [ ] 統合テストが作成されていること

---

#### Day 128: 診断情報のフィルタリング機能
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1](../design/technical-design.md#71-診断機能)
- **推定工数**: 8時間
- **実装詳細**:
  - `getDiagnostics()` メソッドにフィルタオプションを追加
  - 重要度フィルター（error/warning/info/hint）の実装
  - ソースフィルター（typescript/eslint/prettier等）の実装
  - パターンマッチングによるメッセージフィルター
  - 複数条件の論理演算（AND/OR）対応
  - フィルタ結果のキャッシング
- **テスト要件**:
  - 重要度でフィルタできることのテスト
  - ソースでフィルタできることのテスト
  - 複数条件の組み合わせができることのテスト
  - パターンマッチングが正しく動作することのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 127
- **受け入れ基準**:
  - [ ] 重要度でフィルタできること
  - [ ] ソースでフィルタできること
  - [ ] 複数条件の組み合わせができること
  - [ ] 単体テストが作成されていること

---

#### Day 129: 診断情報のキャッシング
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1](../design/technical-design.md#71-診断機能)
- **推定工数**: 8時間
- **実装詳細**:
  - `src/utils/DiagnosticsCache.ts` クラスの実装
  - ファイルパスをキーとした診断結果のキャッシュ
  - ファイル更新イベントによるキャッシュ無効化
  - LRU（Least Recently Used）アルゴリズムによるメモリ管理
  - キャッシュの有効期限管理（デフォルト5分）
  - キャッシュヒット率の統計情報取得
- **テスト要件**:
  - 診断情報が正しくキャッシュされることのテスト
  - ファイル更新時にキャッシュが無効化されることのテスト
  - キャッシュヒット時のレスポンスが高速であることのテスト（10ms以内）
  - LRUアルゴリズムが正しく動作することのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 128
- **受け入れ基準**:
  - [ ] 診断情報がキャッシュされること
  - [ ] ファイル更新時にキャッシュが無効化されること
  - [ ] キャッシュヒット時のレスポンスが高速であること
  - [ ] 単体テストが作成されていること

---

#### Day 130: get_diagnostics ツール定義の完成
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1](../design/technical-design.md#71-診断機能)
- **推定工数**: 8時間
- **実装詳細**:
  - `src/server/tools/GetDiagnosticsTool.ts` クラスの実装
  - MCPツールとしての get_diagnostics 定義
  - 入力パラメータの検証（filePath, severity, source等）
  - DiagnosticsProvider との連携
  - MCPサーバーへのツール登録
  - E2Eテストの作成（実際のMCPクライアントとの通信テスト）
- **テスト要件**:
  - get_diagnostics ツールが listTools() に含まれることのテスト
  - MCPクライアントから正しく呼び出せることのテスト
  - パラメータ検証が正しく動作することのテスト
  - E2Eテストの作成
- **依存関係**: Day 129
- **受け入れ基準**:
  - [ ] get_diagnostics ツールが listTools() に含まれること
  - [ ] MCPクライアントから呼び出せること
  - [ ] E2Eテストが作成されていること

---

### Week 2: クイックフィックス機能の実装（5日間、40時間）

#### Day 131: get_quick_fixes ツールの実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.2](../design/technical-design.md#72-クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.2 の QuickFix 機能を実装
  - `src/managers/DiagnosticsProvider.ts` に `getQuickFixes()` メソッドを追加
  - 診断情報からエディタのクイックフィックスAPIを呼び出し
  - 複数の修正候補の取得と整形
  - 各修正候補の説明文の取得
  - クイックフィックスIDの生成と管理
  - 修正の優先度（preferredFix）の取得
- **テスト要件**:
  - クイックフィックス候補が正しく取得できることのテスト
  - 各修正候補に説明が含まれることのテスト
  - 複数候補がある場合のテスト
  - 候補がない場合のテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 130
- **受け入れ基準**:
  - [ ] クイックフィックス候補が取得できること
  - [ ] 各修正候補に説明が含まれること
  - [ ] 単体テストが作成されていること

---

#### Day 132: クイックフィックスのプレビュー機能
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.2](../design/technical-design.md#72-クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - `getQuickFixes()` メソッドにプレビュー機能を追加
  - 修正前後のテキストdiffの生成
  - unified diff形式での出力
  - 影響範囲（行範囲）の計算と表示
  - 複数ファイルへの影響の検出
  - プレビューデータのキャッシング
- **テスト要件**:
  - diffプレビューが正しく生成されることのテスト
  - 影響範囲が正確であることのテスト
  - 複数ファイルへの影響が検出されることのテスト
  - 統合テストの作成
- **依存関係**: Day 131
- **受け入れ基準**:
  - [ ] diffプレビューが生成されること
  - [ ] 影響範囲が明確であること
  - [ ] 統合テストが作成されていること

---

#### Day 133: apply_quick_fix ツールの実装
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.2](../design/technical-design.md#72-クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.2 の applyQuickFix 機能を実装
  - `src/managers/DiagnosticsProvider.ts` に `applyQuickFix()` メソッドを追加
  - クイックフィックスIDからの修正内容の解決
  - エディタAPIを使用したテキスト編集の適用
  - 複数ファイルへの変更の適用
  - 変更されたファイルの一覧を返却
  - トランザクション処理（全て成功または全て失敗）
- **テスト要件**:
  - クイックフィックスが正しく適用されることのテスト
  - 複数ファイルの変更ができることのテスト
  - 変更されたファイル一覧が正しく返ることのテスト
  - トランザクション処理のテスト（部分失敗時のロールバック）
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 132
- **受け入れ基準**:
  - [ ] クイックフィックスが正しく適用されること
  - [ ] 複数ファイルの変更ができること
  - [ ] 変更されたファイル一覧が返ること
  - [ ] 単体テストが作成されていること

---

#### Day 134: クイックフィックスのロールバック機能
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.2](../design/technical-design.md#72-クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - `applyQuickFix()` メソッドにロールバック機能を追加
  - 適用前のファイル状態のスナップショット保存
  - ロールバック処理の実装
  - undoスタックの管理（最大10件）
  - redoスタックの管理
  - undo/redo履歴の取得API
- **テスト要件**:
  - クイックフィックスをロールバックできることのテスト
  - 複数回のundo/redoができることのテスト
  - undoスタックの上限が正しく機能することのテスト
  - 統合テストの作成
- **依存関係**: Day 133
- **受け入れ基準**:
  - [ ] クイックフィックスをロールバックできること
  - [ ] 複数回のundo/redoができること
  - [ ] 統合テストが作成されていること

---

#### Day 135: get_quick_fixes, apply_quick_fix ツール定義の完成
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.2](../design/technical-design.md#72-クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - `src/server/tools/GetQuickFixesTool.ts` クラスの実装
  - `src/server/tools/ApplyQuickFixTool.ts` クラスの実装
  - MCPツールとしての2つのツール定義
  - 入力パラメータの検証
  - DiagnosticsProvider との連携
  - MCPサーバーへのツール登録
  - E2Eテストの作成（実際のMCPクライアントとの通信テスト）
- **テスト要件**:
  - 2つのツールが listTools() に含まれることのテスト
  - MCPクライアントから正しく呼び出せることのテスト
  - パラメータ検証が正しく動作することのテスト
  - E2Eテストの作成
- **依存関係**: Day 134
- **受け入れ基準**:
  - [ ] 2つのツールが listTools() に含まれること
  - [ ] MCPクライアントから呼び出せること
  - [ ] E2Eテストが作成されていること

---

### Week 3: 診断ソース統合（5日間、40時間）

#### Day 136: TypeScript 診断の統合
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.3](../design/technical-design.md#73-診断ソース統合)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.3 の TypeScript 診断統合を実装
  - DiagnosticsProvider クラスに TypeScript Language Service との連携を追加
  - TypeScript コンパイラAPIを使用した型エラーの取得
  - セマンティックエラーとシンタックスエラーの分類
  - TypeScript 固有のクイックフィックスの取得
  - tsconfig.json の設定読み込みと適用
  - 診断ソース識別子として "typescript" を設定
- **テスト要件**:
  - TypeScript エラーが正しく取得できることのテスト
  - 型エラーが適切に報告されることのテスト
  - TypeScript クイックフィックスが利用できることのテスト
  - tsconfig.json の設定が反映されることのテスト
  - 統合テストの作成
- **依存関係**: Day 135
- **受け入れ基準**:
  - [ ] TypeScript エラーが取得できること
  - [ ] TypeScript クイックフィックスが利用できること
  - [ ] 統合テストが作成されていること

---

#### Day 137: ESLint 診断の統合
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.3](../design/technical-design.md#73-診断ソース統合)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.3 の ESLint 診断統合を実装
  - DiagnosticsProvider クラスに ESLint との連携を追加
  - ESLint の Linter API を使用した診断情報の取得
  - .eslintrc の設定読み込みと適用
  - Lint エラー・警告の重要度マッピング
  - ESLint の autofix 機能を QuickFix として統合
  - 診断ソース識別子として "eslint" を設定
- **テスト要件**:
  - ESLint エラーが正しく取得できることのテスト
  - .eslintrc の設定が反映されることのテスト
  - autofix が QuickFix として利用できることのテスト
  - 統合テストの作成
- **依存関係**: Day 136
- **受け入れ基準**:
  - [ ] ESLint エラーが取得できること
  - [ ] autofix が利用できること
  - [ ] 統合テストが作成されていること

---

#### Day 138: Prettier 統合
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.3](../design/technical-design.md#73-診断ソース統合)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.3 の Prettier 診断統合を実装
  - DiagnosticsProvider クラスに Prettier との連携を追加
  - Prettier API を使用したフォーマット不整合の検出
  - .prettierrc の設定読み込みと適用
  - フォーマット前後のdiff計算
  - 自動フォーマットを QuickFix として提供
  - 診断ソース識別子として "prettier" を設定
- **テスト要件**:
  - フォーマット不整合が正しく検出されることのテスト
  - .prettierrc の設定が反映されることのテスト
  - 自動フォーマットが QuickFix として提案されることのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 137
- **受け入れ基準**:
  - [ ] フォーマット不整合が検出されること
  - [ ] 自動フォーマットが提案されること
  - [ ] 単体テストが作成されていること

---

#### Day 139: その他の診断ソース統合
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.3](../design/technical-design.md#73-診断ソース統合)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.3 の拡張可能な診断ソースアーキテクチャを実装
  - `src/interfaces/IDiagnosticSource.ts` インターフェースの定義
  - プラグイン可能な診断ソースアーキテクチャの構築
  - 診断ソースの動的登録機能
  - 診断ソースの優先度管理
  - Stylelint, HTMLHint等の追加診断ソースの実装例
  - 診断ソースの有効/無効の切り替え機能
- **テスト要件**:
  - 複数の診断ソースが統合されていることのテスト
  - 診断ソースを動的に追加できることのテスト
  - 優先度管理が正しく機能することのテスト
  - 統合テストの作成
- **依存関係**: Day 138
- **受け入れ基準**:
  - [ ] 複数の診断ソースが統合されていること
  - [ ] 診断ソースを動的に追加できること
  - [ ] 統合テストが作成されていること

---

#### Day 140: 診断ソース統合の包括的テスト
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.3](../design/technical-design.md#73-診断ソース統合)
- **推定工数**: 8時間
- **実装詳細**:
  - すべての診断ソースをテストする統合テストスイートの作成
  - `tests/integration/diagnostics-sources.test.ts` の実装
  - 各診断ソース（TypeScript, ESLint, Prettier）の統合テスト
  - 診断の優先度が正しく適用されることのテスト
  - 複数診断ソースからの診断が競合する場合の解決テスト
  - パフォーマンステスト（複数ソース同時実行）
  - テストカバレッジレポートの生成
- **テスト要件**:
  - すべての診断ソースのテストがパスすることの確認
  - テストカバレッジが90%以上であることの確認
  - パフォーマンステストのベンチマーク結果の記録
- **依存関係**: Day 139
- **受け入れ基準**:
  - [ ] すべてのテストがパスすること
  - [ ] テストカバレッジが90%以上であること

---

### Week 4: インテリジェント診断機能（5日間、40時間）

#### Day 141: 診断の優先度付け
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.4](../design/technical-design.md#74-インテリジェント診断)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.4 の診断優先度付け機能を実装
  - `src/utils/DiagnosticsPrioritizer.ts` クラスの実装
  - エラーの深刻度評価アルゴリズム
  - 診断の頻度分析（同じエラーの出現回数）
  - 影響範囲の評価（影響するファイル数、行数）
  - 優先度スコアリングアルゴリズム（0-100の範囲）
  - 優先度に基づいたソート機能
- **テスト要件**:
  - 診断に優先度が正しく付与されることのテスト
  - 重要なエラーが上位に表示されることのテスト
  - 優先度スコアリングアルゴリズムのテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 140
- **受け入れ基準**:
  - [ ] 診断に優先度が付与されること
  - [ ] 重要なエラーが上位に表示されること
  - [ ] 単体テストが作成されていること

---

#### Day 142: 診断の関連性分析
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.4](../design/technical-design.md#74-インテリジェント診断)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.4 の診断関連性分析を実装
  - DiagnosticsPrioritizer クラスに関連性分析機能を追加
  - 同一原因のエラーのグループ化アルゴリズム
  - エラーコードやメッセージパターンによる関連性検出
  - 依存関係の検出（ファイル間の参照関係）
  - ルート原因の特定アルゴリズム
  - 関連診断のグラフ構造生成
- **テスト要件**:
  - 関連する診断が正しくグループ化されることのテスト
  - ルート原因が正確に特定されることのテスト
  - 依存関係の検出が正しく機能することのテスト
  - 統合テストの作成
- **依存関係**: Day 141
- **受け入れ基準**:
  - [ ] 関連する診断がグループ化されること
  - [ ] ルート原因が特定されること
  - [ ] 統合テストが作成されていること

---

#### Day 143: AI駆動の修正提案
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.4](../design/technical-design.md#74-インテリジェント診断)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.4 のAI修正提案機能を実装（オプション機能）
  - `src/utils/AIFixSuggester.ts` クラスの実装
  - エラーパターンの学習機能（過去の修正履歴から学習）
  - LLM APIを使用した修正候補の生成
  - 修正候補の信頼度スコアリング（0-100）
  - コンテキストを考慮した修正提案
  - 修正候補のキャッシング
- **テスト要件**:
  - 修正候補が適切に生成されることのテスト
  - 信頼度スコアが正しく付与されることのテスト
  - エラーパターン学習機能のテスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 142
- **受け入れ基準**:
  - [ ] 修正候補が生成されること
  - [ ] 信頼度スコアが付与されること
  - [ ] 単体テストが作成されていること

---

#### Day 144: 診断レポート生成
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.4](../design/technical-design.md#74-インテリジェント診断)
- **推定工数**: 8時間
- **実装詳細**:
  - 設計書 §7.4 の診断レポート生成機能を実装
  - `src/utils/DiagnosticsReporter.ts` クラスの実装
  - マークダウン形式のレポート生成
  - HTML形式のレポート生成（オプション）
  - 統計情報の集計（エラー数、警告数、ファイル数等）
  - 診断の分類別サマリー
  - トレンド分析（時系列データ）
- **テスト要件**:
  - レポートが正しく生成されることのテスト
  - 統計情報が正確であることのテスト
  - マークダウン形式の妥当性テスト
  - 単体テストカバレッジ90%以上
- **依存関係**: Day 143
- **受け入れ基準**:
  - [ ] レポートが生成されること
  - [ ] 統計情報が含まれること
  - [ ] 単体テストが作成されていること

---

#### Day 145: Phase 6 総合テストとベンチマーク
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.4](../design/technical-design.md#74-インテリジェント診断)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 6の完了確認とパフォーマンスベンチマークの実施
  - `tests/performance/diagnostics-perf.test.ts` の実装
  - 診断取得のパフォーマンステスト（1000ファイルで1秒以内）
  - クイックフィックス適用のパフォーマンステスト
  - メモリ使用量のベンチマーク
  - Phase 6完了レポートの作成
  - パフォーマンスベンチマーク結果の文書化
- **テスト要件**:
  - すべての診断機能が正しく動作することの確認
  - 診断取得が1秒以内であることのパフォーマンステスト
  - テストカバレッジが90%以上であることの確認
  - E2Eテストの実施
- **依存関係**: Day 144
- **受け入れ基準**:
  - [ ] すべての診断機能が動作すること
  - [ ] 診断取得が1秒以内であること
  - [ ] テストカバレッジが90%以上であること

---

### Week 5: ドキュメント整備とリファクタリング（5日間、40時間）

#### Day 146: 診断・修正APIドキュメントの作成
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1-7.4](../design/technical-design.md#7-診断クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - 診断とクイックフィックスのAPIドキュメントを作成
  - `docs/api/diagnostics.md` ファイルの作成
  - get_diagnostics API仕様の詳細な記述（パラメータ、返り値、エラーケース）
  - get_quick_fixes API仕様の記述
  - apply_quick_fix API仕様の記述
  - 診断ソース一覧とそれぞれの特徴
  - サンプルコードとユースケースの記載
  - API使用例の動作確認
- **依存関係**: Day 145
- **受け入れ基準**:
  - [ ] すべてのAPIが文書化されていること
  - [ ] サンプルコードが動作すること

---

#### Day 147: ユーザーガイドの作成
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1-7.4](../design/technical-design.md#7-診断クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - 診断とクイックフィックスのユーザーガイドを作成
  - `docs/user-guide/diagnostics.md` ファイルの作成
  - 診断情報の見方（重要度、ソース、メッセージの解釈）
  - クイックフィックスの使い方（取得、プレビュー、適用）
  - 診断ソースの設定方法（各診断ツールの設定ファイル）
  - トラブルシューティングガイド（よくある問題と解決方法）
  - スクリーンショットと実例の追加
- **依存関係**: Day 146
- **受け入れ基準**:
  - [ ] 初心者でも理解できる内容であること
  - [ ] 実用的な例が含まれていること

---

#### Day 148: エラーハンドリングの改善
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1-7.4](../design/technical-design.md#7-診断クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - 診断機能のエラーハンドリングを見直し改善
  - より詳細で理解しやすいエラーメッセージの実装
  - 診断ソースごとのエラーの分離（TypeScript, ESLint, Prettierのエラーを分けて報告）
  - 一部の診断ソースが失敗しても他のソースは継続するフォールバック機構
  - エラーログの詳細化（スタックトレース、コンテキスト情報）
  - タイムアウト処理の実装（診断取得が遅い場合の対処）
- **テスト要件**:
  - エラーメッセージが明確であることのテスト
  - 一部の診断ソースが失敗しても継続できることのテスト
  - フォールバック機構が正しく機能することのテスト
  - タイムアウト処理のテスト
- **依存関係**: Day 147
- **受け入れ基準**:
  - [ ] エラーメッセージが明確であること
  - [ ] 一部の診断ソースが失敗しても継続できること

---

#### Day 149: コードレビューとリファクタリング
- **タスクタイプ**: TDD 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1-7.4](../design/technical-design.md#7-診断クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 6のコード全体をレビューしリファクタリング
  - コードレビューレポートの作成（問題点、改善提案）
  - 重複コードの削減
  - 関数の責務の明確化と分割
  - 命名規則の統一
  - コメントの追加と改善
  - パフォーマンス最適化（不要な処理の削減）
  - ESLint, Prettier による自動修正の実施
- **テスト要件**:
  - リファクタリング後もすべてのテストがパスすることの確認
  - Lintエラーがないことの確認
  - コードカバレッジが90%以上維持されていることの確認
- **依存関係**: Day 148
- **受け入れ基準**:
  - [ ] Lintエラーがないこと
  - [ ] コードの可読性が向上していること

---

#### Day 150: Phase 6 最終レビューと完了確認
- **タスクタイプ**: DIRECT 🔵
- **要件名**: MCPエディタ統合サーバー
- **要件リンク**: [技術設計書 §7.1-7.4](../design/technical-design.md#7-診断クイックフィックス機能)
- **推定工数**: 8時間
- **実装詳細**:
  - Phase 6の完全性を確認し、次フェーズへの準備を行う
  - Phase 6最終レポートの作成
  - すべての機能の動作確認チェックリスト作成と実施
  - すべてのテストの実行と結果の確認
  - ドキュメントの最終レビューと修正
  - Phase 7への引き継ぎ事項の整理
  - 未解決の課題と改善提案のリスト作成
  - リリースノートの作成
- **依存関係**: Day 149
- **受け入れ基準**:
  - [ ] すべての機能が完成していること
  - [ ] すべてのテストがパスすること
  - [ ] ドキュメントが整備されていること

---

## Phase 6 完了基準

- [ ] get_diagnostics ツールが完全に実装されている
- [ ] get_quick_fixes ツールが完全に実装されている
- [ ] apply_quick_fix ツールが完全に実装されている
- [ ] TypeScript 診断が統合されている
- [ ] ESLint 診断が統合されている
- [ ] Prettier 診断が統合されている
- [ ] 診断のフィルタリングが動作している
- [ ] クイックフィックスのプレビューが動作している
- [ ] 診断のキャッシングが動作している
- [ ] 診断の優先度付けが動作している
- [ ] 単体テストカバレッジが90%以上
- [ ] 統合テストがすべてパスする
- [ ] APIドキュメントとユーザーガイドが完成している

---

## Phase 6 成果物サマリー

| カテゴリ | 成果物 | 推定工数 | 完了 |
|---------|--------|---------|------|
| 診断 | get_diagnostics, getAllDiagnostics | 24時間 | ☐ |
| クイックフィックス | get_quick_fixes, apply_quick_fix | 40時間 | ☐ |
| 診断ソース | TypeScript, ESLint, Prettier統合 | 40時間 | ☐ |
| 高度な機能 | 優先度付け、関連性分析、レポート生成 | 40時間 | ☐ |
| 最適化 | キャッシング、フィルタリング | 16時間 | ☐ |
| テスト | 単体テスト、統合テスト、パフォーマンステスト | 24時間 | ☐ |
| ドキュメント | APIドキュメント、ユーザーガイド | 16時間 | ☐ |
| **合計** | **25タスク** | **200時間** | **0/25** |

---

**前のフェーズ**: [Phase 5: ターミナル・ビルド機能実装](./phase-5-terminal-build.md)
**次のフェーズ**: [Phase 7: テスト・品質保証](./phase-7-testing.md)
